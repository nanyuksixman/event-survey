<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 í…Œí¬ê·¸ë£¹ ì„¤ë¬¸ì¡°ì‚¬ ì°¸ì—¬ ì´ë²¤íŠ¸ ê²°ê³¼ í™•ì¸</title>
    <style>
        body { font-family: 'Apple SD Gothic Neo', sans-serif; text-align: center; padding-top: 50px; background-color: #f9f9f9; }
        h2 { color: #333; margin-bottom: 20px; }
        
        button { background-color: #4a90e2; color: white; border: none; padding: 15px 40px; font-size: 18px; border-radius: 30px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: 0.2s; }
        button:hover { background-color: #357abd; transform: translateY(-2px); }
        button:disabled { background-color: #ccc; cursor: not-allowed; transform: none; }

        input { padding: 10px; font-size: 16px; width: 200px; margin-right: 5px; border: 1px solid #ddd; border-radius: 5px; text-align: center; }

        #status { font-size: 16px; color: #555; line-height: 1.6; padding: 20px; margin-top: 20px;}
        .code-box { background: white; padding: 20px; font-size: 24px; font-weight: bold; color: #d32f2f; margin: 20px auto; width: fit-content; border: 2px dashed #d32f2f; border-radius: 10px; display: none; }
        #winnerForm { display: none; margin-top: 20px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); width: fit-content; margin-left: auto; margin-right: auto;}
    </style>
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            emailjs.init("1eClXvyi7Cegunx5J"); // íšŒì›ë‹˜ Key
        })();
    </script>
</head>
<body>
    <h2>ğŸ í–‰ìš´ê¶Œ ì¶”ì²¨</h2>

    <div id="startScreen">
        <p style="color:#666; margin-bottom: 30px;">
            ì„¤ë¬¸ì— ì°¸ì—¬í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.<br>
            ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ í–‰ìš´ì„ í™•ì¸í•˜ì„¸ìš”!
        </p>
        <button onclick="checkLuck()" id="btnStart">ğŸ² ê²°ê³¼ í™•ì¸í•˜ê¸°</button>
    </div>

    <div id="status"></div>

    <div id="winnerForm">
        <p style="font-size:14px; color:#4a90e2; font-weight:bold;">ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ê²½í’ˆ ë°œì†¡ì„ ìœ„í•´<br>ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
        <input type="text" id="userContact" placeholder="010-XXXX-XXXX">
        <button onclick="submitWinner()" style="padding: 10px 20px; font-size: 14px;">ì „ì†¡</button>
    </div>

    <div id="winCode" class="code-box"></div>

    <script>
        // ============================================================
        // [ì„¤ì • 1] í–‰ìš´ì˜ ì‹œê°„ (ë¶„) ì„¤ì •
        // ì˜ˆ: [10, 30, 50] -> ë§¤ ì‹œê°„ 10ë¶„, 30ë¶„, 50ë¶„ ëŒ€(0ì´ˆ~59ì´ˆ)ì—ë§Œ ë‹¹ì²¨ ê°€ëŠ¥
        // 0~59 ì‚¬ì´ì˜ ìˆ«ìë¥¼ ì›í•˜ëŠ” ë§Œí¼ ë„£ìœ¼ì„¸ìš”.
        var luckyMinutes = [15, 30, 45, 0]; 

        // [ì„¤ì • 2] ê¸°ë³¸ ë‹¹ì²¨ í™•ë¥  (1/30 = ì•½ 0.033)
        // í…ŒìŠ¤íŠ¸í•  ë• 1.0 (100%)ìœ¼ë¡œ í•˜ì‹œê³ , ë°°í¬ ì‹œ 0.033 ì •ë„ë¡œ ë‚®ì¶”ì„¸ìš”.
        var baseWinRate = 1.0; 
        // ============================================================
        
        var generatedCode = "";

        function checkLuck() {
            var btn = document.getElementById('btnStart');
            btn.disabled = true;
            btn.innerText = "í™•ì¸ ì¤‘...";

            setTimeout(function() {
                // 1. í˜„ì¬ ì‹œê°„ ì²´í¬ (ë¶„)
                var currentMinute = new Date().getMinutes();
                var isLuckyTime = luckyMinutes.includes(currentMinute);

                // 2. ì¬ì‹œë„ íšŸìˆ˜ ì²´í¬ (íŒ¨ë„í‹° ì ìš©)
                var tryCount = parseInt(localStorage.getItem('tryCount') || '0');
                localStorage.setItem('tryCount', tryCount + 1); // íšŸìˆ˜ ì¦ê°€

                // 3. ìµœì¢… í™•ë¥  ê³„ì‚°
                var finalRate = baseWinRate;
                
                // ì¬ì‹œë„í•  ë•Œë§ˆë‹¤ í™•ë¥ ì„ ë°˜í† ë§‰ ëƒ„ (1íšŒì°¨: 100%, 2íšŒì°¨: 50%, 3íšŒì°¨: 25%...)
                if (tryCount > 0) {
                    finalRate = finalRate / Math.pow(2, tryCount);
                    console.log("ì¬ì‹œë„ ê°ì§€! í™•ë¥  ê°ì†Œë¨: " + finalRate);
                }

                // 4. ì¶”ì²¨ ë¡œì§ ì‹¤í–‰
                // (ì¡°ê±´: ëŸ­í‚¤íƒ€ì„ì´ì–´ì•¼ í•¨ AND ì£¼ì‚¬ìœ„ê°€ í™•ë¥  ì•ˆì— ë“¤ì–´ì•¼ í•¨)
                if (isLuckyTime && Math.random() < finalRate) {
                    // [ë‹¹ì²¨!]
                    showWinnerForm();
                } else {
                    // [ê½!]
                    showLose();
                }
                
                document.getElementById('startScreen').style.display = 'none';

            }, 1000);
        }

        function showWinnerForm() {
            generatedCode = Math.random().toString(36).substr(2, 6).toUpperCase();
            document.getElementById('winnerForm').style.display = 'block';
        }

        function showLose() {
            document.getElementById('status').innerHTML = 
                "ì•„ì‰½ê²Œë„ ë‹¹ì²¨ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ğŸ˜­<br>ì°¸ì—¬í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.";
        }

        function submitWinner() {
            var contact = document.getElementById('userContact').value;
            if (contact.length < 9) { alert("ì—°ë½ì²˜ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }

            document.getElementById('winnerForm').style.display = 'none';
            document.getElementById('status').innerHTML = "ì„œë²„ë¡œ ì „ì†¡ ì¤‘...";

            var params = { message: "ì—°ë½ì²˜: " + contact + " / ì½”ë“œ: " + generatedCode };
            
            emailjs.send('service_yzbru09', 'template_ynu7hlo', params)
                .then(function() {
                    document.getElementById('status').innerHTML = "<b>âœ… ì ‘ìˆ˜ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!</b>";
                    var codeBox = document.getElementById('winCode');
                    codeBox.innerText = generatedCode;
                    codeBox.style.display = 'block';
                });
        }
    </script>
</body>
</html>
